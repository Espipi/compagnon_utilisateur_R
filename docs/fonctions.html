<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 6 Fonctions | Le compagnon de l’utilisateur R</title>
  <meta name="description" content="Ce livre à pour objectif d’enseigner le language R et son environmenent en très peu de temps." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 6 Fonctions | Le compagnon de l’utilisateur R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ce livre à pour objectif d’enseigner le language R et son environmenent en très peu de temps." />
  <meta name="github-repo" content="VEZY/compagnon_utilisateur_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 6 Fonctions | Le compagnon de l’utilisateur R" />
  
  <meta name="twitter:description" content="Ce livre à pour objectif d’enseigner le language R et son environmenent en très peu de temps." />
  

<meta name="author" content="Vezy Rémi" />


<meta name="date" content="2019-10-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="control-flow.html"/>
<link rel="next" href="environnement.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prérequis</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#oui-mais-cest-quoi-r"><i class="fa fa-check"></i><b>2.2</b> Oui, mais c’est quoi R?</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#pourquoi-r"><i class="fa fa-check"></i><b>2.3</b> Pourquoi R?</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#apprendre-r-et-trouver-de-laide"><i class="fa fa-check"></i><b>2.4</b> Apprendre R et trouver de l’aide</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Premiers.html"><a href="Premiers.html"><i class="fa fa-check"></i><b>3</b> Premiers pas</a><ul>
<li class="chapter" data-level="3.1" data-path="Premiers.html"><a href="Premiers.html#ouvrir-un-projet-rstudio"><i class="fa fa-check"></i><b>3.1</b> Ouvrir un projet RStudio</a></li>
<li class="chapter" data-level="3.2" data-path="Premiers.html"><a href="Premiers.html#organise_project"><i class="fa fa-check"></i><b>3.2</b> Organiser son projet</a></li>
<li class="chapter" data-level="3.3" data-path="Premiers.html"><a href="Premiers.html#creer-un-script-r"><i class="fa fa-check"></i><b>3.3</b> Créer un script <strong>R</strong></a></li>
<li class="chapter" data-level="3.4" data-path="Premiers.html"><a href="Premiers.html#creer-des-objets-et-les-manipuler"><i class="fa fa-check"></i><b>3.4</b> Créer des objets et les manipuler</a><ul>
<li class="chapter" data-level="3.4.1" data-path="Premiers.html"><a href="Premiers.html#objet-unique"><i class="fa fa-check"></i><b>3.4.1</b> Objet unique</a></li>
<li class="chapter" data-level="3.4.2" data-path="Premiers.html"><a href="Premiers.html#vecteur"><i class="fa fa-check"></i><b>3.4.2</b> Vecteur</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="Premiers.html"><a href="Premiers.html#introduction-aux-fonctions-aux-packages-et-a-laide"><i class="fa fa-check"></i><b>3.5</b> Introduction aux fonctions, aux packages et à l’aide</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Structures.html"><a href="Structures.html"><i class="fa fa-check"></i><b>4</b> Structures et types de données</a><ul>
<li class="chapter" data-level="4.1" data-path="Structures.html"><a href="Structures.html#les-types-de-donnees"><i class="fa fa-check"></i><b>4.1</b> Les types de données</a><ul>
<li class="chapter" data-level="4.1.1" data-path="Structures.html"><a href="Structures.html#les-characteres-character"><i class="fa fa-check"></i><b>4.1.1</b> Les charactères (character)</a></li>
<li class="chapter" data-level="4.1.2" data-path="Structures.html"><a href="Structures.html#les-doubles-double"><i class="fa fa-check"></i><b>4.1.2</b> Les doubles (double)</a></li>
<li class="chapter" data-level="4.1.3" data-path="Structures.html"><a href="Structures.html#entiers"><i class="fa fa-check"></i><b>4.1.3</b> Les entiers (integer)</a></li>
<li class="chapter" data-level="4.1.4" data-path="Structures.html"><a href="Structures.html#les-booleens-boolean-or-logical"><i class="fa fa-check"></i><b>4.1.4</b> Les booléens (boolean or logical)</a></li>
<li class="chapter" data-level="4.1.5" data-path="Structures.html"><a href="Structures.html#en-bonus-les-facteurs-factors"><i class="fa fa-check"></i><b>4.1.5</b> En bonus, les facteurs (factors)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Structures.html"><a href="Structures.html#transform_datatype"><i class="fa fa-check"></i><b>4.2</b> Les transformations</a></li>
<li class="chapter" data-level="4.3" data-path="Structures.html"><a href="Structures.html#les-structures-de-donnees"><i class="fa fa-check"></i><b>4.3</b> Les Structures de données</a><ul>
<li class="chapter" data-level="4.3.1" data-path="Structures.html"><a href="Structures.html#vecteurs"><i class="fa fa-check"></i><b>4.3.1</b> Vecteurs</a></li>
<li class="chapter" data-level="4.3.2" data-path="Structures.html"><a href="Structures.html#matrices"><i class="fa fa-check"></i><b>4.3.2</b> Matrices</a></li>
<li class="chapter" data-level="4.3.3" data-path="Structures.html"><a href="Structures.html#tableaux"><i class="fa fa-check"></i><b>4.3.3</b> Tableaux</a></li>
<li class="chapter" data-level="4.3.4" data-path="Structures.html"><a href="Structures.html#listes"><i class="fa fa-check"></i><b>4.3.4</b> Listes</a></li>
<li class="chapter" data-level="4.3.5" data-path="Structures.html"><a href="Structures.html#attributs"><i class="fa fa-check"></i><b>4.3.5</b> Attributs</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="Structures.html"><a href="Structures.html#manipuler-les-structures"><i class="fa fa-check"></i><b>4.4</b> Manipuler les structures</a><ul>
<li class="chapter" data-level="4.4.1" data-path="Structures.html"><a href="Structures.html#index-et-test"><i class="fa fa-check"></i><b>4.4.1</b> Index et Test</a></li>
<li class="chapter" data-level="4.4.2" data-path="Structures.html"><a href="Structures.html#remplacer-assigner"><i class="fa fa-check"></i><b>4.4.2</b> Remplacer, assigner</a></li>
<li class="chapter" data-level="4.4.3" data-path="Structures.html"><a href="Structures.html#concatenation"><i class="fa fa-check"></i><b>4.4.3</b> Concaténation</a></li>
<li class="chapter" data-level="4.4.4" data-path="Structures.html"><a href="Structures.html#transformation"><i class="fa fa-check"></i><b>4.4.4</b> Transformation</a></li>
<li class="chapter" data-level="4.4.5" data-path="Structures.html"><a href="Structures.html#transposition"><i class="fa fa-check"></i><b>4.4.5</b> Transposition</a></li>
<li class="chapter" data-level="4.4.6" data-path="Structures.html"><a href="Structures.html#operations"><i class="fa fa-check"></i><b>4.4.6</b> Opérations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>5</b> Structure de contrôle</a><ul>
<li class="chapter" data-level="5.1" data-path="control-flow.html"><a href="control-flow.html#logical-operators"><i class="fa fa-check"></i><b>5.1</b> Logical operators</a></li>
<li class="chapter" data-level="5.2" data-path="control-flow.html"><a href="control-flow.html#boucles"><i class="fa fa-check"></i><b>5.2</b> Boucles</a><ul>
<li class="chapter" data-level="5.2.1" data-path="control-flow.html"><a href="control-flow.html#boucle-for"><i class="fa fa-check"></i><b>5.2.1</b> Boucle <code>for</code></a></li>
<li class="chapter" data-level="5.2.2" data-path="control-flow.html"><a href="control-flow.html#boucle-while"><i class="fa fa-check"></i><b>5.2.2</b> Boucle while</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="control-flow.html"><a href="control-flow.html#conditions"><i class="fa fa-check"></i><b>5.3</b> Conditions</a></li>
<li class="chapter" data-level="5.4" data-path="control-flow.html"><a href="control-flow.html#fonctions-utiles"><i class="fa fa-check"></i><b>5.4</b> Fonctions utiles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="fonctions.html"><a href="fonctions.html"><i class="fa fa-check"></i><b>6</b> Fonctions</a><ul>
<li class="chapter" data-level="6.1" data-path="fonctions.html"><a href="fonctions.html#definition"><i class="fa fa-check"></i><b>6.1</b> Definition</a></li>
<li class="chapter" data-level="6.2" data-path="fonctions.html"><a href="fonctions.html#declarer-une-fonction"><i class="fa fa-check"></i><b>6.2</b> Déclarer une fonction</a><ul>
<li class="chapter" data-level="6.2.1" data-path="fonctions.html"><a href="fonctions.html#appeler-une-fonction"><i class="fa fa-check"></i><b>6.2.1</b> Appeler une fonction</a></li>
<li class="chapter" data-level="6.2.2" data-path="fonctions.html"><a href="fonctions.html#fonction-sans-argument"><i class="fa fa-check"></i><b>6.2.2</b> Fonction sans argument</a></li>
<li class="chapter" data-level="6.2.3" data-path="fonctions.html"><a href="fonctions.html#fonction-anonyme"><i class="fa fa-check"></i><b>6.2.3</b> Fonction anonyme</a></li>
<li class="chapter" data-level="6.2.4" data-path="fonctions.html"><a href="fonctions.html#return"><i class="fa fa-check"></i><b>6.2.4</b> Return</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="fonctions.html"><a href="fonctions.html#informations"><i class="fa fa-check"></i><b>6.3</b> Informations</a></li>
<li class="chapter" data-level="6.4" data-path="fonctions.html"><a href="fonctions.html#portee-function-scope"><i class="fa fa-check"></i><b>6.4</b> Portée (function scope)</a></li>
<li class="chapter" data-level="6.5" data-path="fonctions.html"><a href="fonctions.html#conseils"><i class="fa fa-check"></i><b>6.5</b> Conseils</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="environnement.html"><a href="environnement.html"><i class="fa fa-check"></i><b>7</b> Environnements</a></li>
<li class="chapter" data-level="8" data-path="dates.html"><a href="dates.html"><i class="fa fa-check"></i><b>8</b> Travailler avec des dates</a></li>
<li class="chapter" data-level="9" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>9</b> Travailler avec des chaînes de charactère</a></li>
<li class="chapter" data-level="10" data-path="datascience1.html"><a href="datascience1.html"><i class="fa fa-check"></i><b>10</b> Science des données: importer, manipuler des données</a></li>
<li class="chapter" data-level="11" data-path="datascience2.html"><a href="datascience2.html"><i class="fa fa-check"></i><b>11</b> Science des données: graphiques</a></li>
<li class="chapter" data-level="12" data-path="communications.html"><a href="communications.html"><i class="fa fa-check"></i><b>12</b> Communications</a></li>
<li class="chapter" data-level="13" data-path="error.html"><a href="error.html"><i class="fa fa-check"></i><b>13</b> Errors, Warnings and Debugging</a></li>
<li class="chapter" data-level="14" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>14</b> Packages</a></li>
<li class="chapter" data-level="15" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>15</b> GIT</a></li>
<li class="chapter" data-level="16" data-path="lang.html"><a href="lang.html"><i class="fa fa-check"></i><b>16</b> Interfacing other languages</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Le compagnon de l’utilisateur R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fonctions" class="section level1">
<h1><span class="header-section-number">Chapitre 6</span> Fonctions</h1>
<div id="definition" class="section level2">
<h2><span class="header-section-number">6.1</span> Definition</h2>
<p>Nous avons déjà introduit les fonctions dans <a href="Premiers.html#Premiers">Premiers pas</a>, mais voici tout de même un petit rappel. Une fonction est une suite d’instructions regroupées en un bloc indépendant, qui prend en général des arguments en entrée, et retourne une valeur. Mais sachez qu’il y a aussi des fonctions qui ne prennent pas d’arguments en entrée, et d’autres qui ne retournent pas de valeurs. Nous allons voir ça dans ce chapitre.</p>
</div>
<div id="declarer-une-fonction" class="section level2">
<h2><span class="header-section-number">6.2</span> Déclarer une fonction</h2>
<p>Voici comment déclarer une fonction:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" title="1">add_one=<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb252-2" title="2">  x<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb252-3" title="3">}</a></code></pre></div>
<p>Il y a beaucoup de nouvelles choses ici ! Alors laissez-moi expliquer étape par étape. D’abord, on a <code>add_one</code>. C’est le nom que nous avons décidé de donner à la fonction, parcequ’elle ajoute 1 à l’argument qu’on lui donne. Ensuite on a un <code>=</code>, qui dit à R que l’on va assigner quelque chose à ce nouveau nom (ici, la fonction). Puis vient <code>function(x){...}</code>. Ici on dit à R que l’on va déclarer une nouvelle fonction, et le code qui y sera associé sera compris entre <code>{</code> et <code>}</code>. On a aussi un <code>(x)</code>: les parenthèses délimitent les arguments de la fonction. Il peut y en avoir 0 avec des parenthèses vides<code>()</code>, un seul comme ici, ou plusieurs séparés avec des virgules comme ceci: <code>(a,b,c)</code>. Ensuite il y a <code>x+1</code>, qui est le code qui sera exécuté à chaque fois que la fonction sera appelée.</p>
<p>Pour appeler une fonction (<em>i.e.</em> s’en servir), on utilise son nom, suivit des arguments:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" title="1"><span class="kw">add_one</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Ici, on dit à R que l’on veut utiliser la fonction <code>add_one</code>, et que x vaut 1. La fonction assigne donc 1 à x, puis lui ajoute 1, et retourne le résultat: 2.</p>
<p>Il est aussi possible de donner des valeurs par défaut aux arguments d’une fonction pour qu’elle utilise toujours cette valeur si on ne donne pas d’argument:
Pour appeler une fonction (<em>i.e.</em> s’en servir), on utilise son nom, suivit des arguments:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" title="1">add_a=<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">a=</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb255-2" title="2">  x<span class="op">+</span>a</a>
<a class="sourceLine" id="cb255-3" title="3">}</a></code></pre></div>
<p>De cette façon, on peut utiliser la fonction comme avant, puisque <code>a</code> vaut 1 par défaut:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1"><span class="kw">add_a</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Mais aussi utiliser l’argument <code>a</code> pour généraliser la fonction:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" title="1"><span class="kw">add_a</span>(<span class="dv">1</span>, <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div id="appeler-une-fonction" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Appeler une fonction</h3>
<p>Jusqu’ici nous avons donné les valeurs des arguments par position. Par example juste au-dessus nous avons appelé la fonction <code>add_a</code> et donné 1 comme valeur à <code>x</code> et 10 pour <code>a</code>. Mais on peut aussi nommer les arguments comme suit:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" title="1"><span class="kw">add_a</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">a =</span> <span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>Ce qui nous permet de donner des valeurs aux arguments dans l’ordre que l’on veut:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb262-1" title="1"><span class="kw">add_a</span>(<span class="dt">a =</span> <span class="dv">10</span>, <span class="dt">x =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>On peut aussi nommer certains arguments, et donner les autres par position:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1"><span class="kw">add_a</span>(<span class="dv">10</span>, <span class="dt">x =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>Dans ce cas les arguments nommés sont rangés automatiquement au bon endroit, et le reste des arguments non nommés sont donnés dans l’ordre restant.</p>
</div>
<div id="fonction-sans-argument" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Fonction sans argument</h3>
<p>On peut aussi déclarer une fonction sans argument. Cela peut s’avérer utile si la fonction doit toujours retourner la même chose (<em>e.g.</em> une liste de courses) ou si elle utilise des informations extérieures.
Par example, disons que vous êtes en voyage au Brésil, où la monnaie est le Real, mais comme vous êtes habitué à payer en Euro, vous aimeriez pouvoir convertir entre les deux simplement. Vous pouvez donc écrire une fonction qui le fait pour vous:</p>
<p>A l’heure où cette version du livre à été mis à jour pour la dernière fois, 1 Euro (€) valait 4.526 Reals (R$)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
<p>Cette fonction peut maintenant nous servir à convertir n’importe quelle valeur depuis R, en appliquant la conversion actuelle. Si par example on veut acheter une télévision pour 2506.756 Reals, combien cela fait-il en euro?</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">TV=<span class="st"> </span><span class="fl">2506.756</span>  </a>
<a class="sourceLine" id="cb266-2" title="2">TV<span class="op">/</span><span class="kw">currencyfunc</span>()</a></code></pre></div>
<pre><code>## [1] 553.8568</code></pre>
<p>Cela fait 553.8568272 euros!</p>
<blockquote>
<p>Les <code>::</code> dans <code>quantmod::getQuote()</code> permettent de dire à R d’utiliser la fonction <code>getQuote()</code> du package <code>quantmod</code>. Il est préférable d’utiliser cette notation dès que possible pour pouvoir se rappeler de quel package l’on a besoin pour utiliser un code en particulier, mais aussi pour éviter d’utiliser des fonctions qui ont le même nom dans deux packages différents, ou dans notre code et un package.</p>
</blockquote>
</div>
<div id="fonction-anonyme" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Fonction anonyme</h3>
<p>Une fonction anonyme est une fonction sans nom. On utilise généralement ces fonctions lorsque l’on utilise des fonctions qui prennent en argument d’autres fonctions. Commençons par un example, la fonction <code>Map()</code>.</p>
<p>La fonction <code>Map()</code> prend comme argument une fonction, et un objet. Elle applique ensuite cette fonction à chaque élément de cet objet. Par exemple si l’on a plusieur prix de TV, on peut appliquer notre conversion <code>currencyfunc()</code> à chacune en utilisant une fonction anonyme:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1">TVs=<span class="st"> </span><span class="kw">c</span>(<span class="fl">2432.753</span>, <span class="fl">2638.554</span>, <span class="fl">2439.369</span>, <span class="fl">2559.210</span>, <span class="fl">2400.950</span>, <span class="fl">2514.662</span>, <span class="fl">2517.128</span>, <span class="fl">2416.149</span>, <span class="fl">2537.907</span>, <span class="fl">2458.432</span>)</a>
<a class="sourceLine" id="cb268-2" title="2"><span class="kw">unlist</span>(<span class="kw">Map</span>(<span class="cf">function</span>(x)x<span class="op">/</span><span class="kw">currencyfunc</span>(), TVs))</a></code></pre></div>
<pre><code>##  [1] 537.5062 582.9770 538.9680 565.4463 530.4795 555.6036 556.1485
##  [8] 533.8376 560.7395 543.1798</code></pre>
<p>Comme on peut le voir on utilise la fonction <code>MAP()</code> avec comme premier argument <code>function(x)x/currencyfunc()</code>, qui est une fonction anonyme, et qui est appliquée à chaque élément du deuxième argument, <code>TVs</code>.</p>
<blockquote>
<p>NB: on utilise aussi la fonction <code>unlist()</code> ici pour re-formater la sortie de <code>MAP()</code> (plus adapté pour le livre).</p>
</blockquote>
<p>Bien sûr il s’agit d’un example ici, car sinon nous aurions pu directement avoir le résultat comme ceci:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1">TVs<span class="op">/</span><span class="kw">currencyfunc</span>()</a></code></pre></div>
<pre><code>##  [1] 537.5062 582.9770 538.9680 565.4463 530.4795 555.6036 556.1485
##  [8] 533.8376 560.7395 543.1798</code></pre>
<p>Cette dernière façon de procéder est en général à préférer car R vectorize par défaut toute fonction, ce qui veut dire qu’une fonction peut s’appliquer par défaut à chaque membre d’un objet. Ceci est un aspect très apréciable de R.</p>
</div>
<div id="return" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Return</h3>
<p>Une fonction retourne par défaut le dernier objet, mais il existe aussi une fonction spéciale pour retourner explicitement un objet particulier. Cette fonction s’appelle <code>return()</code>. De manière générale, il vaut mieux eviter de l’utiliser car elle a tendance à ralentir l’exécution (voir ce <a href="https://style.tidyverse.org/">style guide</a>), et plutôt préférer répéter</p>
<p>Quelques examples:</p>
<p>La fonction retourne le dernier objet:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1">return_<span class="dv">10</span>=<span class="st"> </span><span class="cf">function</span>(a,b){</a>
<a class="sourceLine" id="cb272-2" title="2">  a<span class="op">*</span>b</a>
<a class="sourceLine" id="cb272-3" title="3">  x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb272-4" title="4">  x</a>
<a class="sourceLine" id="cb272-5" title="5">}</a>
<a class="sourceLine" id="cb272-6" title="6"></a>
<a class="sourceLine" id="cb272-7" title="7"><span class="kw">return_10</span>(<span class="dv">20</span>,<span class="dv">30</span>)</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Ici la fonction calcule bien <code>a*b</code>, mais retourne 10 car <code>x</code> vaut 10, et il est retourné à la fin. Cette écriture est exactement la même que celle-ci:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">return_<span class="dv">10</span>=<span class="st"> </span><span class="cf">function</span>(a,b){</a>
<a class="sourceLine" id="cb274-2" title="2">  a<span class="op">*</span>b</a>
<a class="sourceLine" id="cb274-3" title="3">  x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb274-4" title="4">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb274-5" title="5">}</a>
<a class="sourceLine" id="cb274-6" title="6"></a>
<a class="sourceLine" id="cb274-7" title="7"><span class="kw">return_10</span>(<span class="dv">20</span>,<span class="dv">30</span>)</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>Maintenant que ce passe-t-il si l’on met un <code>return()</code> à la ligne <code>a*b</code> ?</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">return_<span class="dv">10</span>=<span class="st"> </span><span class="cf">function</span>(a,b){</a>
<a class="sourceLine" id="cb276-2" title="2">  <span class="kw">return</span>(a<span class="op">*</span>b)</a>
<a class="sourceLine" id="cb276-3" title="3">  x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb276-4" title="4">  x</a>
<a class="sourceLine" id="cb276-5" title="5">}</a>
<a class="sourceLine" id="cb276-6" title="6"></a>
<a class="sourceLine" id="cb276-7" title="7"><span class="kw">return_10</span>(<span class="dv">20</span>,<span class="dv">30</span>)</a></code></pre></div>
<pre><code>## [1] 600</code></pre>
<p>La fonction retourne <code>a*b</code> ! En effet, la fonction <code>return()</code> stoppe l’exécution de la fonction dans laquelle elle est appelée, et retourne le résultat qui y figure comme argument. Pour forcer une fonction à ne rien retourner, on peut aussi appeler <code>return()</code> sans arguments:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1">return_<span class="dv">10</span>=<span class="st"> </span><span class="cf">function</span>(a,b){</a>
<a class="sourceLine" id="cb278-2" title="2">  a<span class="op">*</span>b</a>
<a class="sourceLine" id="cb278-3" title="3">  x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb278-4" title="4">  x</a>
<a class="sourceLine" id="cb278-5" title="5">  <span class="kw">return</span>()</a>
<a class="sourceLine" id="cb278-6" title="6">}</a>
<a class="sourceLine" id="cb278-7" title="7"></a>
<a class="sourceLine" id="cb278-8" title="8"><span class="kw">return_10</span>(<span class="dv">20</span>,<span class="dv">30</span>)</a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Voilà, la fonction calcule bien toutes les lignes avant le <code>return()</code>, mais ne retourne rien.</p>
<p>La fonction <code>return()</code> peut être très utile lorsque l’on veut retourner un résultat directement si une condition est vraie:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1">return_whatever=<span class="st"> </span><span class="cf">function</span>(a,b){</a>
<a class="sourceLine" id="cb280-2" title="2">  <span class="cf">if</span>(b<span class="op">&gt;</span>a){</a>
<a class="sourceLine" id="cb280-3" title="3">    <span class="kw">return</span>(a<span class="op">/</span>b)</a>
<a class="sourceLine" id="cb280-4" title="4">  }</a>
<a class="sourceLine" id="cb280-5" title="5">  truc=<span class="st"> </span>a<span class="op">*</span>b</a>
<a class="sourceLine" id="cb280-6" title="6">  truc<span class="op">*</span><span class="dv">10</span><span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb280-7" title="7">}</a>
<a class="sourceLine" id="cb280-8" title="8"></a>
<a class="sourceLine" id="cb280-9" title="9"><span class="kw">return_10</span>(<span class="dv">20</span>,<span class="dv">30</span>)</a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Ici on force un retour de <code>a/b</code> si <code>b&gt;a</code>, et sinon on exécute une suite d’opérations et on retourne la dernière ligne.</p>
<blockquote>
<p>Pour que la dernière ligne soit retournée automatiquement, il faut qu’elle retourne un résultat, donc il est important qu’elle ne soit pas une assignation (<em>e.g.</em> n= a+b), ou une modification (<em>e.g.</em> n[1]= a+b), sinon rien ne sera retourné.</p>
</blockquote>
</div>
</div>
<div id="informations" class="section level2">
<h2><span class="header-section-number">6.3</span> Informations</h2>
<p>Pour connaître les arguments d’une fonction, il vous suffit d’exécuter son nom précédé d’un point d’intérogation (<em>e.g.</em> <code>?sum</code>), ou bien de surligner son nom et appuyer sur la touche <code>F1</code> de votre clavier dans RStudio. Apparaîtra alors la documentation de la fonction, qui est toujours structurée de la même manière: en haut se trouve le nom de la fonction suivi du nom du package auquel elle appartient entre crochets (nb: base est le package intégré de base dans R). Ensuite vient une description brève, puis son utilisation. Ici apparaitra donc les différentes façons d’utiliser la fonction, ainsi que les valeurs par défaut de ses paramètres.
Vient ensuite une description de chaque arguments, puis de certains détails d’utilisation, des valeurs retournées par la fonction (Value), puis enfin les notes, les références, les fonctions liées (see also) et, le plus important, d’examples.</p>
<p>Pour accéder au code d’une fonction, il suffit de la surligner et d’appuyer sur la touche <code>F2</code> de votre clavier. Le code de certaines fonctions n’est pas accessible par ce moyen, il s’agit par example des fonctions primitives (<em>e.g.</em> <code>sum()</code>) ou les fonctions utilisant des méthodes (e.g. <code>plot()</code>). Il vous faudra donc aller le chercher sur un dépôt (e.g. CRAN, Github…).</p>
</div>
<div id="portee-function-scope" class="section level2">
<h2><span class="header-section-number">6.4</span> Portée (function scope)</h2>
<p>R fonctionne avec des environnements (voir <a href="environnement.html#environnement">Environnements</a>). Chaque fonction crée son propre environnement lorsqu’elle est appelée, c’est à dire qu’elle n’a accès qu’à son propre environement en priorité, puis ensuite aux environnements aux dessus si elle ne trouve pas un objet dans le sien.</p>
<p>Donc a priori un objet crée dans une fonction ne modifie pas celui déclaré auparavant.
Voici un example:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1">x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb282-2" title="2"></a>
<a class="sourceLine" id="cb282-3" title="3">add_<span class="dv">10</span>=<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb282-4" title="4">  x=<span class="st"> </span>x<span class="op">+</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb282-5" title="5">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb282-6" title="6">}</a>
<a class="sourceLine" id="cb282-7" title="7"></a>
<a class="sourceLine" id="cb282-8" title="8">x2=<span class="st"> </span><span class="kw">add_10</span>(x)</a>
<a class="sourceLine" id="cb282-9" title="9"></a>
<a class="sourceLine" id="cb282-10" title="10"><span class="kw">c</span>(<span class="dt">x=</span> x, <span class="dt">x2=</span> x2)</a></code></pre></div>
<pre><code>##  x x2 
## 10 20</code></pre>
<p>Ici on voit que l’on a déclaré <code>x</code> avec pour valeur 10. Ensuite on passe <code>x</code> à la fonction <code>add_10</code> qui déclare <code>x</code> dans son propre environnement, puis lui ajoute 10, et retourne sa valeur. On peut voir qu’à la fin en dehors de la fonction, le <code>x</code> que nous avons crée nous-mêmes est toujours égal à 10 après avoir appelé la fonction.
Par contre si R ne trouve pas une valeur dans son environnement, il va essayer de chercher dans les environnements au-dessus. L’environnement le plus haut est l’environnement de l’utilisateur. Donc la fonction peut potentiellement avoir accès aux objets que l’utilisateur à crée lui-même:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1">a=<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb284-2" title="2">x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb284-3" title="3"></a>
<a class="sourceLine" id="cb284-4" title="4">add_a=<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb284-5" title="5">  x=<span class="st"> </span>a<span class="op">+</span>x</a>
<a class="sourceLine" id="cb284-6" title="6">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb284-7" title="7">}</a>
<a class="sourceLine" id="cb284-8" title="8"></a>
<a class="sourceLine" id="cb284-9" title="9">x2=<span class="st"> </span><span class="kw">add_a</span>(x)</a>
<a class="sourceLine" id="cb284-10" title="10"></a>
<a class="sourceLine" id="cb284-11" title="11"><span class="kw">c</span>(<span class="dt">a=</span> a, <span class="dt">x=</span> x, <span class="dt">x2=</span> x2)</a></code></pre></div>
<pre><code>##  a  x x2 
##  2 10 12</code></pre>
<p>Comme on peut le voir, <code>a</code> n’a pas été donné comme argument de la fonction, pourtant elle s’est débrouillée pour aller le chercher dans l’environnement global tout de même, là où nous l’avons déclaré. Cela peut être dangereux car parfois on oublie tout simplement de passer un objet comme argument, et alors R va utiliser un objet qui n’est pas le même à nos yeux, mais qui portera le même nom. Il faut y faire très attention. A noter que ce phénomène n’est pas valable pour les packages car les objets à l’intérieur d’un package sont isolés de l’environnement global. C’est pourquoi il est préférable de regrouper ses fonctions en un package (voir <a href="packages.html#packages">Packages</a>).</p>
<p>La bonne façon d’écrire la fonction ci-dessus est la suivante:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1">a=<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb286-2" title="2">x=<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb286-3" title="3"></a>
<a class="sourceLine" id="cb286-4" title="4">add_a=<span class="st"> </span><span class="cf">function</span>(x,a){</a>
<a class="sourceLine" id="cb286-5" title="5">  x=<span class="st"> </span>a<span class="op">+</span>x</a>
<a class="sourceLine" id="cb286-6" title="6">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb286-7" title="7">}</a>
<a class="sourceLine" id="cb286-8" title="8"></a>
<a class="sourceLine" id="cb286-9" title="9">x2=<span class="st"> </span><span class="kw">add_a</span>(x, a)</a>
<a class="sourceLine" id="cb286-10" title="10"></a>
<a class="sourceLine" id="cb286-11" title="11"><span class="kw">c</span>(<span class="dt">a=</span> a, <span class="dt">x=</span> x, <span class="dt">x2=</span> x2)</a></code></pre></div>
<pre><code>##  a  x x2 
##  2 10 12</code></pre>
<p>De cette façon, on peut réutiliser la fonction avec d’autres objets:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">b=<span class="st"> </span><span class="dv">15</span></a>
<a class="sourceLine" id="cb288-2" title="2">x3=<span class="st"> </span><span class="kw">add_a</span>(x, b)</a>
<a class="sourceLine" id="cb288-3" title="3"></a>
<a class="sourceLine" id="cb288-4" title="4"><span class="kw">c</span>(<span class="dt">a=</span> a, <span class="dt">b=</span>b,<span class="dt">x=</span> x, <span class="dt">x2=</span> x2)</a></code></pre></div>
<pre><code>##  a  b  x x2 
##  2 15 10 12</code></pre>
</div>
<div id="conseils" class="section level2">
<h2><span class="header-section-number">6.5</span> Conseils</h2>
<ul>
<li>Nommer une fonction est difficile, alors voici quelques recommendations:
<ul>
<li>toujours écrire en anglais. Celà permet de partager (et demander de l’aide) plus facilement;<br />
</li>
<li>nommer votre fonction avec un verbe suivit d’un nom, séparées par un "_", <em>e.g.</em> split_list. Celà permet de comprendre très rapidement ce qu’une fonction fait (ici on divise une liste en morceaux).</li>
</ul></li>
<li><p>Garder le nombre d’arguments au minimum, et nommez-les de façon hommogène par rapport aux fonctions existantes dans R, et dans vos fonctions.</p></li>
<li><p>Toujours (<strong>toujours !</strong>) écrire l’aide de votre fonction directement après l’avoir écrite. Ce conseil vous évitera des heures de relecture de codes lorsque vous devrez vous replonger dans la fonction dans 6 mois.</p></li>
<li><p>Une fonction doit faire une seule chose, mais bien. Si une fonction fait plusieurs choses, alors c’est qu’elle doit être divisée en plusieurs fonctions. Ce conseil est très important, plus une fonction est concise, plus elle est facile à ré-utiliser, à débugger, et à lire.</p></li>
<li><p>Essayer de grouper ses fonctions en un script séparé qui ne sert qu’à déclarer les fonctions (pas d’utilisation) puis l’utiliser pour déclarer toutes les fonctions d’un seul coup et rapidement en utilisant la fonction <code>source()</code>. Ou mieux, créer un package.</p></li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>données <a href="https://fr.finance.yahoo.com/">Yahoo Finance</a> téléchargées grâce à la fonction <code>getQuote</code> du package <code>quantmod</code><a href="fonctions.html#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="control-flow.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="environnement.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["compagnon.pdf", "compagnon.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
